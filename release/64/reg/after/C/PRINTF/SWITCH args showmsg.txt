/***************************************************************************$NL** 版权所有:  WeiLai Copyright (c) 2020-2030  ******************************$NL** 文件名称:  $LO<<<\1>>>msg.cpp$NL** 当前版本:  v1.0$NL** 作$TB者:$NL** 完成日期: $DATEX$NL** 修改记录:$NL** 修改记录:$NL** 修改日期:$NL** 版本号  :$NL** 修改人  :$NL** 修改内容:$NL***************************************************************************/$NL$NL$NL/*****************************头文件****************************************/$NL$NL/*****************************宏定义****************************************/$NL$NL/*****************************结构体或类型定义*******************************/$NL$NL$NL/*****************************全局变量****************************************/$NL$NL$NL/*****************************本地变量****************************************/$NL$NL$NL/*****************************函数或类声明****************************************/$NL$NL$NL/*****************************函数或类实现****************************************/$NL$NL$NL$NL$NL$NL$NL$NL$NL/*****************************by extern "C"****************************************/$NL$NL#ifdef __cplusplus$NLextern "C" {$NL#endif$NL$NL/*****************************头文件****************************************/$NL#include <stdio.h>$NL#include <stdlib.h>$NL#include <unistd.h>$NL#include <string.h>$NL#include <sys/types.h>$NL#include <sys/time.h>$NL#include <sys/fcntl.h>$NL#include <assert.h>$NL#include <stdarg.h>$NL#include "$LO<<<\1>>>msg.h"$NL$NL/*****************************宏定义****************************************/$NL$NL$NL/*****************************结构体或类型定义*******************************/$NL$NL$NL/*****************************全局变量****************************************/$NL$NL$NL/*****************************本地变量****************************************/$NL$NL$NL/*****************************函数或类声明****************************************/$NL$NL$NL/*****************************函数或类实现****************************************/$NLvoid \1LogSw(unsigned int dwSw, const char *pTips, char *fmt,...)$NL{$NL#define BUFMAX (2048)$NL$NL$TBif((NULL == fmt) || (NULL == pTips) || (0 == dwSw))$NL$TB{$NL$TB$TBreturn;$NL$TB}$NL$NL$TBchar cBuf[BUFMAX] = {0};$NL$NL$TB//1定义参数列表$NL$TBva_list ap;$NL$TB//2初始化参数列表$NL$TBva_start(ap,fmt);$NL$TBvsnprintf(cBuf, sizeof(cBuf), fmt, ap);$NL$TB//3关闭参数列表$NL$TBva_end(ap);$NL$NL$TBprintf("tip[%s],buf:%s\n", pTips, cBuf);$NL$NL}$NL$NLvoid \1MsgSw(unsigned int dwSw, const char *pTips, unsigned char *pucMsg, unsigned int dwLen, char *fmt,...)$NL{$NL#define BUFMAX (2048)$NL$NL$TBunsigned int dwLp =  0;$NL$NL$TBif((NULL == fmt) || (NULL == pTips)|| (NULL == pucMsg)|| (0 == dwLen) || (0 == dwSw))$NL$TB{$NL$TB$TBreturn;$NL$TB}$NL$NL$TBchar cBuf[BUFMAX] = {0};$NL$NL$TB//1定义参数列表$NL$TBva_list ap;$NL$TB//2初始化参数列表$NL$TBva_start(ap,fmt);$NL$TBvsnprintf(cBuf, sizeof(cBuf), fmt, ap);$NL$TB//3关闭参数列表$NL$TBva_end(ap);$NL$NL$TB//时间$NL$TBstruct tm tmx;$NL$TBtime_t curTime = time(NULL);$NL$TBlocaltime_r(&curTime, &tmx);$NL$NL$TBfprintf(stdout, "\n[%04d/%02d/%02d %02d:%02d:%02d]",$NL$TB$TB$TBtmx.tm_year + 1900,$NL$TB$TB$TBtmx.tm_mon + 1,$NL$TB$TB$TBtmx.tm_mday,$NL$TB$TB$TBtmx.tm_hour,$NL$TB$TB$TBtmx.tm_min,$NL$TB$TB$TBtmx.tm_sec$NL$TB$TB$TB);$NL$NL$TBfprintf(stdout, "tips:%s,buf:%s,msglen:%u", pTips, cBuf, dwLen);$NL$NL$TBfor(dwLp = 0;dwLp < dwLen;dwLp++)$NL$TB{$NL$TB$TBif(dwLp % 16 == 0)$NL$TB$TB{$NL$TB$TB$TBprintf("\n");$NL$TB$TB}$NL$NL$TB$TBif((dwLp % 8 == 0) && (dwLp % 16 != 0))$NL$TB$TB{$NL$TB$TB$TBprintf(" ");$NL$TB$TB}$NL$TB$TBprintf("%02X ", pucMsg[dwLp]);$NL$TB}$NL$TBprintf("\n\n");$NL}$NL$NL$NL$NL#ifdef __cplusplus$NL}$NL#endif