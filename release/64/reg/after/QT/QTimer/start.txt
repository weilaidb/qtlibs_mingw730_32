#include <QTimer>$NL$NLprivate:$NL   QTimer  \1;//定时器$NL$NLprivate slots:$NL   void   \2(); //定期器处理槽函数$NL$NL$NL$NL$NLconnect(&\1,SIGNAL(timeout()),this,SLOT(\2()));$NL$NLvoid Dialog::\2()$NL{ //定时器溢出处理槽函数$NL  int  tmpSeq=0,tmpValue=0;$NL  bool  valid=threadA.readValue(&tmpSeq,&tmpValue); //读取数值$NL  if (valid && (tmpSeq!=mSeq)) //有效，并且是新数据$NL  {$NL    mSeq=tmpSeq;$NL    mDiceValue=tmpValue;$NL    QString  str=QString::asprintf("第 %d 次掷骰子，点数为：%d", mSeq,mDiceValue);$NL   ui->plainTextEdit->appendPlainText(str);$NL   QPixmap pic;$NL   QString filename=QString::asprintf(":/dice/images/d%d.jpg",mDiceValue);$NL   pic.load(filename);$NL   ui->LabPic->setPixmap(pic);$NL  }$NL}$NL$NL$NLvoid Dialog::on_btnStartThread_clicked()$NL{//启动线程 按钮$NL    threadA.start();$NL    mSeq=0;$NL$NL    ui->btnStartThread->setEnabled(false);$NL    ui->btnStopThread->setEnabled(true);$NL$NL    ui->btnDiceBegin->setEnabled(true);$NL    ui->btnDiceEnd->setEnabled(false);$NL}$NL$NLvoid Dialog::on_btnDiceBegin_clicked()$NL{//开始 掷骰子按钮$NL    threadA.diceBegin();$NL    mTimer.start(100); //定时器100ms读取一次数据$NL$NL    ui->btnDiceBegin->setEnabled(false);$NL    ui->btnDiceEnd->setEnabled(true);$NL}$NL$NLvoid Dialog::on_btnDiceEnd_clicked()$NL{//暂停 掷骰子按钮$NL    threadA.dicePause();$NL    ui->btnDiceBegin->setEnabled(true);$NL    ui->btnDiceEnd->setEnabled(false);$NL}$NL$NL$NLvoid Dialog::on_btnStopThread_clicked()$NL{//结束线程 按钮$NL    threadA.stopThread();//结束线程的run()函数执行$NL    threadA.wait();//$NL$NL    ui->btnStartThread->setEnabled(true);$NL    ui->btnStopThread->setEnabled(false);$NL$NL    ui->btnDiceBegin->setEnabled(false);$NL    ui->btnDiceEnd->setEnabled(false);$NL}$NL