【showfilecontent.jsp内容】$NL<%--======================\1模板=========================--%>$NL<%--======================\1模板=========================--%>$NL<%--======================\1模板=========================--%>$NL<%$NL$TBboolean have\2 = CStringPub.isContain\2Field(selectitem);$NL$TBString str\2House = "";$NL$TBString \3Item = "";$NL$TBif(have\2)$NL$TB{$NL$TB$TB\3Item = CStringPub.get\2();$NL$TB$TB\3Item = CFilePub.getTipsName(\3Item);$NL$TB}$NL%>$NL<%--读取\1模板内容--%>$NL<file:ReadTag dir="<%=topdir%>" fileName="<%=\3Item%>"></file:ReadTag>$NL<%$NL$TBif(have\2)$NL$TB{$NL$TB$TBstr\2House = result.toString();$NL$TB$TBstr\2House = CStringPub.replaceEnter2Br(str\2House);$NL$TB}$NL%>$NL$NL$NL$NL$NL$NL$NL$NL$NL$NL$NL$NL$TB<%$NL$TB$TBif(have\2){$NL$TB%>$NL$TB<input type="button" value="\1框架" onclick="add\2House('<%=str\2House%>','<%=selectitem%>')" style="margin-right: 10px;width: 80px"/>$NL$TB<input type="button" value="关闭"   onclick="closewindow()" style="margin-right: 10px;width: 80px"/>$NL$TB<%$NL$TB$TB}$NL$TB%>$NL$NL$NL$NL$NL$TBfunction add\2House(house,selectitem)$NL$TB{$NL$TB$TBselectitem = selectitem.replaceAll("\1/", "")$NL$TB$TB$TB.replaceAll("\2/","");$NL$TB$TBvar opid = "left";$NL$TB$TBvar lefttext = document.getElementById(opid).value;$NL$TB$TBvar testCaseHouse = house.replaceAll("<br/>", "\n")$NL$TB$TB$TB.replaceAll("☆标题","☆标题\n" + selectitem)$NL$TB$TB$TB.replaceAll("☆内容","☆内容\n")$NL$TB$TB$TB.replaceAll("☆附加信息\n","☆附加信息\n")$NL$TB$TB$TB.replaceAll("☆提交日期","☆提交日期\n" + currentDate())$NL$TB$TB;$NL$NL$TB$TB// alert(lefttext);$NL$NL$TB$TBdocument.getElementById(opid).innerHTML  = testCaseHouse + lefttext ;$NL$TB}$NL$NL$NL$NL$NL【autocodesets.jsp 内容】$NL$TBfunction import\2()$NL$TB{$NL$TB$TB// alert("import\2");$NL$TB$TBdocument.form.action="import\2.jsp";$NL$TB$TB// document.form.target = "";$NL$TB$TBdocument.form.target = "_blank";$NL$TB$TBdocument.form.submit();$NL$TB}$NL$NL$TBfunction export\2()$NL$TB{$NL$TB$TB// alert("export\2");$NL$TB$TBdocument.form.action="export\2.jsp";$NL$TB$TB// document.form.target = "";$NL$TB$TBdocument.form.target = "_blank";$NL$TB$TBdocument.form.submit();$NL$TB}$NL$NL$NL$NL$NL$NLboolean have\2 = CStringPub.isContain\2Field(findtext);$NL$NL$NL<%--$TB$TB\1 --%>$NL$TB$TB<%$NL$TB$TB$TBif(have\2)$NL$TB$TB$TB{$NL$TB$TB%>$NL$TB$TB$TB$TB<input type="button" value="\1导入"  formatarget="_blank" onclick="import\2()" style="margin-right: 10px;width: 80px"/>$NL$TB$TB$TB$TB<input type="button" value="\1导出"  formatarget="_blank" onclick="export\2()" style="margin-right: 10px;width: 80px"/>$NL$TB$TB<%$NL$TB$TB$TB}$NL$TB$TB%>$NL$NL$NL$NL【export\2.jsp】$NL$NL<%$NL$TB//获取\1模板的内容，形成表格$NL$TBString str\2House = "";$NL$TBString \3Item = "";$NL$TB\3Item = CStringPub.get\2();$NL$TB\3Item = CFilePub.getTipsName(\3Item);$NL$NL$TBint \3Nums = 0;$NL%>$NL$NL$NL$NL=======================================>>>>>>>>>>>$NL$NL$NL$NL$NL$NL$NL$NL$NL$NL$NL$NL$NL$NL$NL$NL$NL$NL$NL