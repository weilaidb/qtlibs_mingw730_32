================================================$NL#ifndef $UP<<<\1>>>_H$NL#define $UP<<<\1>>>_H$NL$NL#include <iostream>$NLusing namespace std;$NL$NLtypedef int (*pFnHander1)(int);$NL$NL$NL$NL$NLclass \1 {$NLprotected:$NL$TBint width, height;$NLpublic:$NL$TB\1( int a=0, int b=0);$NL$TBvirtual int init();$NL$TBvirtual int setcallback(pFnHander1 pFn);$NL$TBvirtual pFnHander1 getcallback();$NL$TBvirtual int proccallback(void);$NL$NLprivate:$NL$TBpFnHander1 mFn1;$NL$NLpublic:$NL$TBstatic \1* GetInstance();$NL$TBstatic void SetInstance(\1* pInstance);$NL$NLprivate:$NL$TBstatic \1* m_pInstance;$NL};$NL$NL$NL$NL#endif // $UP<<<\1>>>_H$NL$NL================================================$NL#include "$LO<<<\1>>>.h"$NL$NL\1* \1::m_pInstance = NULL;$NL\1* \1::GetInstance()$NL{$NL$TBif ( m_pInstance == NULL )$NL$TB{$NL$TB$TBm_pInstance = new \1;$NL$TB}$NL$NL$TBreturn m_pInstance;$NL}$NL$NLvoid \1::SetInstance(\1* pInstance)$NL{$NL$TBm_pInstance = pInstance;$NL}$NL$NL$NL\1::\1( int a, int b)$NL{$NL$TBwidth = a;$NL$TBheight = b;$NL$TBmFn1 = 0;$NL}$NL$NL$NLint \1::init()$NL{$NL$TBcout << "Parent class init :" <<endl;$NL$TBreturn 0;$NL}$NL$NLint \1::setcallback(pFnHander1 pFn)$NL{$NL$TBcout << "Parent set callback" <<endl;$NL$TBmFn1 = pFn;$NL$TBreturn 0;$NL}$NL$NLpFnHander1 \1::getcallback()$NL{$NL$TBreturn mFn1;$NL}$NL$NLint \1::proccallback(void)$NL{$NL$TBif(getcallback())$NL$TB{$NL$TB$TBcout << "Parent proc callback" <<endl;$NL$TB$TBgetcallback()(123);$NL$TB}$NL$TBelse$NL$TB{$NL$TB$TBcout << "Parent proc nothing, callback null!" <<endl;$NL$TB}$NL$TBreturn 0;$NL}$NL$NL================================================$NL#ifndef $UP<<<\2>>>_H$NL#define $UP<<<\2>>>_H$NL#include <$LO<<<\1>>>.h>$NL$NL$NLclass \2: public \1{$NLpublic:$NL$TB\2( int a=0, int b=0);$NL$TBint init ();$NL};$NL$NL$NL$NL#endif // $UP<<<\2>>>_H$NL$NL================================================$NL#include "$LO<<<\2>>>.h"$NL$NLint test1(int iPara)$NL{$NL$TBcout << "test1 called,para:" << iPara << endl;$NL$TBreturn 0;$NL}$NL$NL$NL\2::\2( int a, int b):\1(a, b)$NL{$NL$TBinit ();$NL}$NL$NLint \2::init ()$NL{$NL$TBcout << "\2 class init :" <<endl;$NL$TBsetcallback(test1);$NL$TBreturn (width * height);$NL}$NL$NL================================================$NL#ifndef $UP<<<\3>>>_H$NL#define $UP<<<\3>>>_H$NL#include "$LO<<<\1>>>.h"$NL$NLclass \3: public \1{$NLpublic:$NL$TB\3( int a=0, int b=0);$NL$TBint area ();$NL};$NL$NL$NL#endif // $UP<<<\3>>>_H$NL$NL================================================$NL#include "$LO<<<\3>>>.h"$NL$NL\3::\3( int a, int b):\1(a, b)$NL{$NL$TBinit ();$NL}$NL$NLint \3::area ()$NL{$NL   cout << "\3 class init :" <<endl;$NL   return (width * height / 2);$NL}$NL$NL================================================$NL#include <iostream>$NL#include <$LO<<<\1>>>.h>$NL#include <$LO<<<\2>>>.h>$NL#include <$LO<<<\3>>>.h>$NLusing namespace std;$NL$NL$NL$NL$NL// 程序的主函数$NLint main( )$NL{$NL$TB\1::SetInstance(new \2());$NL$NL$TB\1::GetInstance()->proccallback();$NL$NL$TBreturn 0;$NL}$NL$NL$NL================================================$NL$NL================================================