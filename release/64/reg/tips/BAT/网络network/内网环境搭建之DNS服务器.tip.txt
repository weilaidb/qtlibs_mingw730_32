内网环境搭建之DNS服务器
皮卡皮卡丘
皮卡皮卡丘
13 人赞同了该文章
本篇文章是模拟在内网里面搭建一台简单的DNS服务器,关于更多的服务器搭建可以看看这本书

内网安全攻防 渗透测试实战指南
京东
¥49.50
去购买
​
0x00:环境需求
1. 准备需求：一台PC和一台服务器，这里我们用的是win7和Windows 2012。

关于iso文件可以在MSDN那里下载




0x01:基础知识了解
2. 首先，我们需要了解一下什么是DNS，DNS全名叫做”Domain Name Service”，也就是所谓的域名服务。域名由”主机名+域名组成”，也就是所谓的完全限定域名。举个例子：如:"http://www.baidu.com"是一个域名，从严格意义上讲，"http://baidu.com"才被称为域名(全球唯一)，而"www"是主机名

"主机名.域名"称为完全限定域名(FQDN)，一个域名下可以有多个主机，域名全球唯一，那么"主机名.域名"肯定也是全球唯一的。

域名分为根域，顶级域，一级域，二级域等组成，其构造为树状图（如下图所示）。


0x02:端口服务与解析
3. 接着我们需要知道DNS服务器的端口和DNS的解析种类。DNS服务器的端口分别为TCP 53和UPD 53。DNS的解析种类分为两种，分别是递归查询和迭代查询。递归查询：客户机与本地DNS服务器之间叫做递归查询。迭代查询：本地DNS服务器与根等其他DNS服务器的解析过程叫迭代查询（如下图所示）。




0x03:环境搭建
4. 接着我们就要来开始搭建DNS服务器了。首先我们需要给win 2012配置静态IP，因为win2012我们需要做DNS服务器，所以我们需要保证它的IP不会发生改变（注意：固定win2012 iP的时候需要保证win7和win 2012需要在同一网段内，因为我们的win7的IP是192.168.10.129，子网掩码是255.255.255.0，所以我们需要把win2012也配置在这个网段里面）。




这里我们配置win2012IP为1921.168.10.200




然后我们用win7去ping win2012，让它们俩人能互相通信。




接着我们在打开win2012的服务器管理，找到添加角色与功能，然后添加一个DNS服务器的功能，然后安装。




安装完成以后，我们在服务器管理里面找到工具，然后找到DNS服务器，点击打开就能看见DNS管理器了。







然后我们点击这个地方




鼠标右键点击正向查找区域，然后新建区域




然后下一步，然后会让你选择建立哪种区域，这里我们选择主要区域，继续下一步，接着会让我们给区域起一个名字，这里我们取的名字如下




然后下一步，会让你选择新建区域文件还是使用一个从另一个DNS服务器复制过来的现存文件，因为我们没有现存文件，所以选择新建，继续下一步，然后会让我们选择区域更新，这里我们选中间那个，然后继续下一步就完成了。

5. 接着我们点击这个新建好的区域，然后右键单击右边的空白区域，点击新建主机。




因为我们这里是在虚拟环境里搭建，所以主机名字可以自己起也可以随便起，而IP地址也是这里，这里我们起的名字和IP地址分别为www和1.1.1.1




这个时候，我们的DNS服务器和做实验用的域名已经准备好了，然后我们打开win7的控制面板，点击网络与internet，打开网络与共享中心，然后点击更改适配器设置，右键点击本地连接，点击属性，找到Internet协议版本4，双击打开，点击使用下面的DNS服务器地址前面的勾号，然后在首选DNS服务器里面写上我们所搭建的DNS服务器IP（192.168.10.200），然后应用并确定。




最后打开win7的cmd命令框，输入解析域名的命令（nslookup）解析刚刚搭建好的主机




发现解析出来的IP地址根我们所输入的IP是一样的，所以我们这算是成功搭建了一台DNS服务器。

