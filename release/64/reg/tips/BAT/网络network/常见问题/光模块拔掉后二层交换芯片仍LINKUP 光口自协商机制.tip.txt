光口自协商机制

https://zhiliao.h3c.com/Theme/details/184257


光口自协商机制
光模块2021-12-22 发表
关注0关注
收藏0收藏 335浏览

刘倩
问题描述
如题

解决方法
1. 关于光口自协商可参考如下解答

两边自协商情况下，端口按照标准协议，双方互发/C/码流，码流中会带上本端端口信息（支持的速率、双工模式以及fault状态等）。如果连续接收到3个相同的/C/码且接收到的码流和本端工作方式相匹配，则返回给对方一个带有ACK应答的/C/码，对端接收到ACK信息后，认为两者可以互通，则端口可以UP。

两边强制情况下，双方互相发送/I/码流（携带强制的速率双工信息），一端接收到/I/码流后，认为对端是与自己相匹配的端口（速率双工本端支持），则端口即可UP。

由于是两个厂商设备对接，两个厂商端口使用不同的芯片，会涉及不同芯片间的适配性问题。在自协商情况下，可能会不能UP。

2. 这个协商参数有什么标准规范吗？

===》可以参考803标准37章节37. Auto-Negotiation function, type 1000BASE-X。

我们设备发送的C码流都包含什么信息？是否有方法看到收发的C码流信息？

===》码流中主要包含 支持的速率、双工模式以及local fault状态。 没有办法看到C码流信息。都是按照标准协议处理的，不同厂商应该都是差不多的。

比如我们遇到和思科某个型号的，很大概率会出现这个现象。

===》不同厂商使用的PHY芯片不同，不同PHY芯片内部某些细节方面的实现以及参数设置是不同的，可能会影响自协商。

3. 两端的自协商要up，必须速率双工匹配，没有local fault

以前碰到过经过传输不能up的，传输设备是一对多的，这样有可能把协商信号传到其他端口

如果不能自协商起来，可以两端都配置强制速率双工，这样会关闭自协商

Speed 1000

Duplex full