全基因组关联分析(GWAS)神器——PLINK
酸菜
酸菜​
科研等 2 个话题下的优秀答主
110 人赞同了该文章
全基因组关联分析（GWAS）越来越火了，但是对于全基因组庞大的数据好多同学感到无法下手，那么我们要如何处理这些数据呢？有请我们今天的主人公——PLINK软件闪亮登场。


软件介绍
PLINK是一个免费的开源全基因组关联分析工具集，旨在以高效率计算的方式执行一系列基本的、大规模的分析。PLINK的重点分析对象是基因型或者表型数据，可以为后续的可视化、注释和结果存储提供一些支持。

【1】工具下载：http://www.cog-genomics.org/plink2/


【2】功能介绍：http://zzz.bwh.harvard.edu/plink/ld.shtml




输入文件准备
.ped文件

PED文件用空格或制表符分割，每行为一个样本：


.map文件
文件中必须且仅包含四列，依次为:


值得一提的是在遗传距离一列中，大多数分析在任何情况下都不需要指定遗传图谱。指定遗传图谱（cM）对于寻找个体之间共享区段的一组分析至关重要。对于基本关联测试，可以将“遗传距离”列设置为0

ps.SNP标识符可以包含除空格或制表符之外的任何字符；另外，还应避免在名称中使用*符号

要从分析中排除SNP，请将第4列（物理碱基对位置）设置为任何负值


测试软件

两个输入文件准备就绪，我们接下来要测试一下软件及所需数据是否在当前路径下。

首先以“Win+R”的方式点开命令窗口，在输入“cmd”进入命令界面。最后将地址定位到存放软件的目录下输入：

plink --file chr21


待出现如下情境即为目标文件中含有所需文件







软件实操+结果解读
（1）读入文件:
此时需要两个文件chr21.ped和chr21.map。若两个文件具有不同的名称，则可以分别指定PED和MAP文件：

plink --ped chr21.ped --map chr21.map
当PLINK启动时，它将尝试与网络联系，以检查是否有更新的版本。可以使用命令行中的—noweb选项可以禁止联网更新。

（2）缺失率统计：
plink --file chr21 --missing --out miss_stat

miss_stat.imiss文件为个体缺失位点信息



miss_stat.limiss文件为单个SNP缺失的个体数



ps.在命令中“miss_stat”表示输出文件名，这里大家可以自行定义。

（3）等位基因频率统计：
plink --file chr21 --freq --out freq_stat
运行该命令会生成.frq结尾的文件




在这里也顺便为大家介绍一下什么是MAF：

MAF是次要等位基因频率，即频率较低的等位基因的频率。为了防止在具有低覆盖量或深度的序列中，有低MAF的样本可能会产生很多噪音，导致假阳性的下游分析。

在等位基因频率统计中我们也可以通过以下命令生成每个 SNP 的基因型计数和哈代温伯格测试统计信息的列表：

plink --file chr21 --hardy --out hardy1



ps.在输出文件中，每个SNP有三个条目（行），TEST可以是ALL、AFF（仅限案例）或UNAFF（仅限对照）

（4）关联分析：
基本关联检验是针对一种疾病特征进行的，它是基于比较病例和对照组之间的等位基因频率

基本的案例对照关联测试：

plink --file chr21 --assoc



Fisher精确检验（等位基因关联）：
plink --file chr21 –-fisher



可选/全模型关联检验：
通过使用—model选项，可以执行疾病与基本等位基因测试（将病例与对照中的等位基因频率进行比较）以外的其他变体之间的关联测试。此处提供的测试是（除了基本的等位基因测试）：

[1]Cochran-Armitage趋势检验

[2]基因型检验

[3]显性基因行为检验

[4]隐性基因行为检验

Cochran-Armitage 检验的一个优点是，它不假定 Hardy-Weinberg 平衡。表现出与Hardy-Weinberg严重偏离的SNP通常很可能是不良SNP，或者反映了样品中的分层，因此在许多情况下最好将其排除。

基因型检验为（疾病×基因型）的一个2×3的表格提供了一个一般的关联分析检验。显性和隐性模型是对次要等位基因的测试（次要等位基因可以在—assoc或—freq命令的输出中找到）。

通过以下命令产生上述检验：

plink --file chr21 --model


生成.model文件，如下图所示：





（4）孟德尔错误：
使用以下命令生成SNP及其家族的孟德尔错误列表

plink --file chr21 --mendel
将创建以下四种文件：

[1]plink.mendel

[2]plink.imendel

[3]plink.fmendel

[4]plink.lmendel



*.mendel包含以下条目：

*.imendel包含以下条目：

*.fmendel包含以下条目：

*.lmendel包含以下条目：

通过使用全基因组SNP标记对群体孟德尔错误率的经验分布进行分析,该方法不仅可以简单、快速、准确地判别系谱的正确性,而且还可以对错误系谱进行校正。

ps.此测试数据未有孟德尔错误，大家可以根据各自研究数据进行验证如果小伙伴想要了解其他使用方法，可登录官方网站http://zzz.bwh.harvard.edu/plink/ld.shtml进行查询。

实战案例
接下来介绍一下这款软件的实际应用。

在2018年5月发表于Scientific Reports的名为” Association of a rare variant of the TNFSF13B gene with susceptibility to Rheumatoid Arthritis and Systemic Lupus Erythematosus”







在这篇文章中则是完全利用PLINK进行课题研究，作者在固定效应模型下，采用逆方差法进行荟萃分析。最终得出TNFSF13B BAFF-var在对Rheumatoid arthritis (RA) 的敏感性中起重要作用，并证实了该变异体与systemic lupus erythematosus (SLE) 的关联。这篇文献我们也将其存放在资料中，各位感兴趣的话可以自行阅读。



结语
学完了这款软件是不是想马上操作一番，我们也在资料中存放了测试数据” example.map”,” example.ped”.大家可以测试一下，让知识更加牢固。

最后，使用此软件不要忘记引用参考文献欧：[1] Purcell S, et al. PLINK: A Tool Set for Whole-Genome Association and Population-Based Linkage Analyses. Am. J. Hum. Genet. 2007;81:559–575. doi: 10.1086/519795.





微信公众号“挑圈联靠”回复日行一膳02，得范例文献和数据

本文首发于“挑圈联靠”微信公众号

转载请注明：解螺旋·临床医生科研成长平台

发布于 2020-07-06 17:46