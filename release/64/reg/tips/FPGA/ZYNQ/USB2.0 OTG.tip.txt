USB OTG原理简述

小菜菜13

于 2018-05-02 23:00:00 发布

24289
 收藏 103
分类专栏： 嵌入式 文章标签： USB OTG
版权

嵌入式
专栏收录该内容
7 篇文章2 订阅
订阅专栏
USB OTG即USB On-The-Go的缩写，他目的是实现在没有Host的情况下，实现设备间的数据传送。例如数码相机直接连接到打印机上，通过OTG技术，连接两台设备间的USB口，将拍出的相片立即打印出来；手机读写U盘。
OTG 检测的原理是:
　　USB OTG标准在完全兼容USB2.0标准的基础上，增添了电源管理（节省功耗）功能，它允许设备既可作为主机，也可作为外设操作（两用OTG）。USB OTG技术可实现没有主机时设备与设备之间的数据传输。
USB OTG接口中有5条线：
2条用来传送数据（D+ 、D-）;
1条是电源线(VBUS);
1条则是接地线(GND)、
1条是ID线。ID线—以用于识别不同的电缆端点，mini-A插头(即A外设)中的ID引脚接地，mini-B插头（即B外设）中的ID引脚浮空。当OTG设备检测到接地的ID引脚时，表示默认的是A设备（主机），而检测到ID引脚浮空的设备则认为是B设备（外设）。


举个例子：
当我们手机使用OTG线接U盘时，一般手机OTG线，手机端时mini头，里面的ID被接到了GND，另一端是正常USB的母座，只有4pin，没有ID脚，相当于悬空。手机就是设备A，因为ID脚被连到了GND，所以手机端的USB OTG控制器读取到ID的状态为低，因此手机就作为主设备。而U盘端ID悬空，故被当做从设备B。
总结：
当设备检测到USB_ID信号为低时，该设备应作为Host（主机，也称A设备）用。
当设备检测到USB_ID信号为高时，该设备作为Slave(外设，也称B设备）用。
实际的USB连接线中，是没有USB_ID这根线的。 都是在接口部分直接拉死的的。
对于Host端，只需将连接线的USB_ID pin和地短接即可，
对于Slave端，USB连接线的USB_ID pin是悬空的。（设备内部上拉）。

OTG有两种设备类型:两用OTG设备(Dualrole device)和外设式OTG设备(Peripheralonly OTG device) 。两用OTG设备要提供有限的主机能力和一个MiniAB插座、支持主机流通协议(Host Negotiatio n Protocol, HNP),并和外设式OTG设备一样支持事务请求协议(Session Request Protocol, SRP)。当作为主机工作时,两用OTG设备可在总线上提供8mA的电流,而以往标准主机则需要 提供100～500 mA的电流。


————————————————
版权声明：本文为CSDN博主「小菜菜13」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/u010538116/article/details/80173538