S12700 V200R013C00 配置指南-QoS
本文档介绍了如何配置QoS功能，主要包括MQC配置、优先级映射配置、流量监管配置、流量整形配置、接口限速配置、拥塞避免配置、拥塞管理配置、报文过滤配置、重定向配置、流量统计配置、基于ACL的简化流策略配置和HQoS配置。
前言
QoS简介
MQC配置
优先级映射配置
流量监管、流量整形和接口限速配置
流量监管、流量整形和接口限速简介
流量监管、流量整形和接口限速原理描述
流量评估与令牌桶技术
流量监管
流量整形
接口限速
流量监管、流量整形和接口限速应用场景
流量监管、流量整形和接口限速配置注意事项
流量监管、流量整形和接口限速缺省配置
配置流量监管
配置流量整形
配置接口限速
维护流量监管、流量整形和接口限速
流量监管、流量整形和接口限速配置举例
流量监管、流量整形和接口限速FAQ
拥塞避免和拥塞管理配置
报文过滤配置
重定向配置
流量统计配置
基于ACL的简化流策略配置
HQoS配置
搜索本手册内容

流量整形
流量整形是一种主动调整流量输出速率的措施，其作用是限制流量与突发，使这类报文以比较均匀的速率向外发送。流量整形通常使用缓冲区和令牌桶来完成，当报文的发送速度过快时，首先在缓冲区进行缓存，在令牌桶的控制下，再均匀地发送这些被缓冲的报文。

处理流程
流量整形是一种队列的流量控制技术，可以对从接口上经过的某类报文进行速率限制。

下面以采用单速单桶技术的基于流的队列整形为例介绍流量整形的处理流程，其处理流程如图4-5所示。

图4-5  流量整形处理流程图

具体处理流程如下：

当报文到来的时候，首先对报文进行分类，使报文进入不同的队列。
若报文进入的队列没有配置队列整形功能，则直接发送该队列的报文；否则，进入下一步处理。
按用户设定的队列整形速率向令牌桶中放置令牌：
如果令牌桶中有足够的令牌可以用来发送报文，则报文直接被发送，在报文被发送的同时，令牌做相应的减少。
如果令牌桶中没有足够的令牌，则将报文放入缓存队列，如果报文放入缓存队列时，缓存队列已满，则丢弃报文。
缓存队列中有报文的时候，会与令牌桶中的令牌数作比较，如果令牌数足够发送报文则转发报文，直到缓存队列中的报文全部发送完毕为止。
