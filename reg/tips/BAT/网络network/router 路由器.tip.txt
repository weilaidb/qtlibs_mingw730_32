https://wenku.baidu.com/view/d46fafd2172ded630b1cb6e4.html

路由器技术 
1.路由器基本概念
路由是把数据从一个网络转发到另一个网络的过程，完成这个过程的设备就是路由器
2.路由器技术的构成
通常所说的路由技术其实是由两项最基本的活动组成，即决定最优路径和传输信息单元（也称为数据包）
其中，数据包的传输和交换相对较为简单和直接，而路由的确定则更加复杂一些。
3.路由器
路由器是一种连接多个网络或网段的网络设备，它能将不同网络或网段之间的数据信息进行“翻译“，以使它们能够相互”读“懂对方的数据，从而构成一个更大的网络。
4.路由表和目的地址 
》路由表保存着目的IP地址和下一个网关地址的映射关系
》路由器中共有四种目的地址：
>与路由器在同一子网的目的主机或网段地址
>路由器中明确定义的目的主机或网络地址
>由路由器收到ICMP重定向消息所确定的目的主机或网络地址
>所有其它的目的主机或网络地址

5.路由表查找：最长匹配
eg:
Packet:Destination
IP address:10.1.1.1

R2's IP routing table
10/8->R3
10.1/16->R4  <--->Longest match, 16 bit netmask 
20/8->R5
...


6.静态路由
优点：
》对于路由器的CPU没有管理性开销
》在路由器之间没有带宽占用
》增加了安全性
缺点：
》必须真正地了解所配置的互联网络，以及每台路由器应该如何正确地连接以正确配置这些路由。
》如果某个网络加入到互联的网络中，必须在所有的路由器上（人工）添加对它的路由。
》大型网络不可行

7.静态路由配置命令
》配置静态路由用命令ip route 
router(config)#ip route [网络编号][子网掩码][转发路由器的IP地址/本地接口]

8.静态路由配置实例 
router(config)#ip route 172.16.1.0 255.255.255.0 172.16.2.1
或
router(config)#ip route 172.16.1.0 255.255.255.0 serial 0

9.默认路由
》默认路由可以转发那些在路由表中没有列出的远端目的网络的数据包到下一跳路由器。
》在存根网络上可以只使用默认路由，即那些与外界只有一个输出连接的网络。
》默认路由是一个使用通配符来代替网络和子网掩码的静态路由
》配置缺少路由用如下命令：
router(config)#ip route 0.0.0.0 0.0.0.0 [转发路由器的IP地址/本地接口]

10.默认路由器配置实例
router(config)#ip route 0.0.0.0 0.0.0.0 172.16.2.2

11.动态路由
》动态路由是指路由器能够自动地建立自己的路由表，并且能够根据实际情况的变化适时地进行调整。
》路由方法：
路由器会将自己的已知信息发给相邻路由器。最终每台路由器都会收到网络中所有路由器的信息。然后通过相应算法计算出最终路由。

12.动态路由协议的分类
》外部网关协议：在自治系统之间交换路由选择信息的互联网协议，如BGP。
》内部网关协议：在自治系统内交换路由选择信息的路由协议，常用的因特网内部网关协议有OSPF、RIP、IGRP、EIGRP。

13.路由选择协议基础
管理距离（AD)
》用来衡量接收来自相邻路由器上路由选择信息的可信度管理距离（0~255），0是最可依赖的，255则意味着不会有业务通过这个路由。
》如路由器接收到两个对于同一远程网络的更新内容，路由器首先AD。带有最低AD值的路由将会被放置在路由表中。
》AD相同，则路由协议的度量值（如跳计数或链路的带宽值）将被用做寻找到达远程网络最佳路径的依据，最低度量值的路由将被放置在路由表中。AD相同及度量相同，负载均衡（即它所发送的数据包会平分到每个链路上）。

14.默认的管理距离
》路由源 默认AD
》连接接口 0
》静态路由 1
》EIGRP    90
》IGRP     100
》OSPF     110
》RIP      120

15.路由度量
》跳数（hop count):分组从源结点到达目的结点经过的路由器的个数。
》带宽（bandwidth)--链路的传输速率。
》延时（delay)--分组从源结点到达目的结点花费的时间。
》负载(load)--通过路由器或线路的单位时间通信量。
》可靠性（reliability)--网络链路的可信度（通常指单位时间内链路的失效次数）
》开销(overhead)--传输过程中的耗费，与所使用的链路带宽相关。


16.距离矢量型路由协议
》RIP和IGRP是距离矢量路由选择协议。
》数据包每通过一个路由器，称为一跳。使用最少跳数量到达网络的路由被认为最佳路由。
》它们发送整个路由表到直接相邻的路由器。
》路由表信息的更新
若项目中的目的网络不在路由表中，则将该项目添加到路由表中（距离D值加1）。
否则
	若下一跳字段给出的路由器地址是同样的，则将收到的项目替换原路由表中的项目。
否则
	若收到的项目中距离加1的值小于路由表中的距离值，则进行更新。
	否则，什么也不做。

17.RIPv1-构建路由表
向谁传送，传送什么，何时传递
路由器不了解网络的确切拓扑信息
Routing table 
10.1.0.0 E0 0 
路由收敛

18.路由环路的形成
定义最大跳


19.解决路由环路的方法：水平分割
》路由器不会把那些从它的某个接口学到的路由再从同接口通告出去
》水平分割默认启动

20.路由中毒与毒性反转
》路由中毒：是指在路由信息在路由表中失效时，先将度量值变在无穷大，而不是马上从路由表中删掉这条路由信息。（RIP协议中，其度量值变为16，意味着路由不可达）再将其信息发布出去，这样相邻的路由器就得知这条路由已无效了。

》毒性反转与路由中毒是不一样的，它是指收到路由中毒消息的路由器，不遵守水平分割原则将中毒消息转发给所有的相邻路由器，也包括发送中毒信息的源路由器，也就是通告相邻路由器这条路由信息已失效了，主要目的是达到快速收敛的目的。

》当一条路径信息变为无效之后，路由器不立即将它从路由表中删除，而是用16，即不可达的度量值将它广播出去。缺点是增加了路由表的大小。

21.触发更新
得知网络拓扑结构发生改变，不等待发送周期，立刻通告更新后全部的路由表

22.RIP定时器 
》路由更新定时器  用于设置定期路由更新的时间间隔（典型为30秒），在这个间隔里路由器发送一个自己路由表的完整拷贝到所有相邻的路由器。
》路由失效定时器  路由器在认定一个路由成为无效路由 之前所需要的时间间隔。如果路由器在这个期间内没有得到关于某个指定路由的任何更新信息，它将认为这个路由失效。
》保持失效定时器  路由信息被抑制的时间
》路由刷新定时器  设置某个路由为无效路由并从路由表中删除的时间间隔（240秒）

23.Hold-down倒记时
hold-down倒记时以后更新路由表
等待网络中其它路由器收敛，在该时间内不学习任何与该网络相关的路由信息（RIP缺省180秒），在倒记时期间继续向其它路由器发送毒化信息


24.配置RIP路由
Router(config)#router rip
启动RIP路由协议 
Router(config)#network network-number
路由选择协议要通告哪些网络，并启用相应的接口参数与动态路由协议的运行进程 

25.内部网关路由协议（IGRP）
》IGRP，Cisco专用的距离矢量路由选择协议
》IGRP的最大跳计数值为255，默认时为100
》IGRP使用了与RIP不同的度量值，默认时，使用带宽和线路延迟作为判断到达某个互联网最佳路由的量度，称为合成度量。可靠性、负载和最大传输单元（MTU）也可以用做度量。
》IGRP必须使用相同的自治系统号来共享路由表信息

》配置IGRP路由
Router(config)#route igrp AS号
Router(config-router)#network network-number

IGRP可实现多达6条链路的负载均衡。RIP网络要实现负载均衡必须具有相同的跳计数，而IGRP使用带宽来决定如何实现负载均衡。

26.链路状态型路由协议
》链路状态型路由协议和距离矢量型路由协议相比有以下特点：
>没有跳数限制
>以路径花费值作为选择最佳路径的度量。Cost是能够体现带宽的一个参数。所以路由器可以使用链路的实际带宽选择路径而不是路数。
>事件触发(Event triggered)的更新机制，并非像距离矢量型协议那样更新。
>增量更新。
>更新的是链路状态数据库而不是路由表。
>路由器有一个完整和同步的网络拓扑图，没有环路。
>需要更多的内存和更大的处理能力
>网络初期LSA的扩散可能会占用大量的带宽。







